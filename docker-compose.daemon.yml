services:
  ai-intercom:
    build: .
    container_name: ai-intercom-daemon
    restart: unless-stopped
    network_mode: host
    command: ["daemon", "--config", "/app/config/config.yml"]
    environment:
      - HUB_URL=${HUB_URL}
      - INTERCOM_TOKEN=${INTERCOM_TOKEN}
      - HOME=${HOME:-/home/gilles}  # Claude CLI needs HOME for credentials
    volumes:
      - ./config/config.yml:/app/config/config.yml:ro
      - intercom-data:/app/data
      - ${HOME:-/home/gilles}:${HOME:-/home/gilles}  # Host filesystem for agent launching

volumes:
  intercom-data:
